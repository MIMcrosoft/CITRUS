{% load static %}

<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Demande de report</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #f0f0f5;
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        .air-datepicker-global-container{
            z-index: 9999;
        }
        .card {
            background: white;
            width: 400px;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            text-align: center;
        }

        h1 {
            margin-top: 0;
            font-size: 24px;
            color: #333;
        }

        p {
            color: #555;
            margin-bottom: 25px;
        }

        .buttons {
            display: flex;
            justify-content: space-between;
        }

        .btn {
            width: 48%;
            padding: 12px 0;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            transition: 0.2s;
        }

        .btn-accept {
            background: #28a745;
            color: white;
        }

        .btn-accept:hover {
            background: #1f8737;
        }

        .btn-decline {
            background: #dc3545;
            color: white;
        }

        .btn-decline:hover {
            background: #b52b38;
        }
    </style>
    <link rel="stylesheet" href="{% static 'stylesheets/components/generalStyles.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/air-datepicker@3.5.3/air-datepicker.min.css" rel="stylesheet">

</head>
<style>
    .alert {
        padding: 12px;
        border-radius: 8px;
        margin-bottom: 15px;
        font-size: 14px;
    }
    .alert.error {
        background: #f8d7da;
        color: #721c24;
    }
    .alert.success {
        background: #d4edda;
        color: #155724;
    }
</style>
<body style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
    {% if messages %}
        <div class="messages">
            {% for message in messages %}
                <div class="alert {{ message.tags }}">
                    {{ message }}
                </div>
            {% endfor %}
        </div>
    {% endif %}
    {% if coach_complete %}
        <div class="card">

            <h1>Demande de report de match</h1>

            <p>
                Une demande de report de match à été créée par {{ requete.cree_par }} le {{ requete.date_creation }}
            </p>

            <b>Détails de la demande</b>
            <p style="text-align: left">
                <b>Match : </b>{{ requete.match.equipe2.nom_equipe }} Vs {{ requete.match.equipe1.nom_equipe }} <br>
                <b>Lieu : </b>{{ requete.match.equipe1.college }} <br>
                <b>Date : </b>{{ requete.match.get_dateFormatted }} <br>
                <b>Nouvelle date proposée :</b> {{ requete.nouvelle_date }} <br>
            </p>

            <p>
                La demande à déjà été completée. Pour tout problème, veuillez contacter un administrateur.
            </p>
        </div>

    {% endif %}
    {% if not coach_complete %}
        <form method="POST">
            {% csrf_token %}
            <div class="card">
            <h1>Demande de report de match</h1>

            <p>
                Une demande de report de match à été créée par {{ requete.cree_par }} le {{ requete.date_creation }}
            </p>

            <b>Détails de la demande</b>
            <p style="text-align: left">
                <b>Match : </b>{{ requete.match.equipe2.nom_equipe }} Vs {{ requete.match.equipe1.nom_equipe }} <br>
                <b>Lieu : </b>{{ requete.match.equipe1.college }} <br>
                <b>Date : </b>{{ requete.match.get_dateFormatted }} <br>
                <b>Nouvelle date proposée :</b> {{ requete.nouvelle_date }} <br>
            </p>

            <div id="nouvelleDate" style="display: none">
                <b>Proposer une nouvelle date</b>
                <input type="text" name="nouvelle_date" id="nouvelle_date" class="calendar" autocomplete="off">
            </div>

            <div id="primaryButtons" class="buttons">
                <button type="submit" name="choice" value="accepter" class="btn btn-accept">Accepter</button>
                <button id="btnRefuser" type="button" name="choice" value="declinee" class="btn btn-decline">Refuser</button>
            </div>
            <div id="secondaryButtons" class="buttons" style="display: none">
                <button type="submit" name="choice" value="decliner" class="btn btn-accept">Modifier</button>
                <button type="button" class="btn btn-secondary" id="returnBtn">Retourner</button>
            </div>
        </div>
        </form>
    {% endif %}


    <script>

        let btnRefuser = document.getElementById("btnRefuser");
        btnRefuser.addEventListener("click", function (event) {
            event.preventDefault();

            let nouvelleDateDiv = document.getElementById("nouvelleDate");
            let primaryBtns = document.getElementById("primaryButtons");
            let secondaryBtns = document.getElementById("secondaryButtons")

            primaryBtns.style.display = "none";
            secondaryBtns.style.display = "flex";
            nouvelleDateDiv.style.display = "block";

        });

        let btnRetourner = document.getElementById("returnBtn");
        btnRetourner.addEventListener("click", function (event){
            event.preventDefault()

            let nouvelleDateDiv = document.getElementById("nouvelleDate");
            let primaryBtns = document.getElementById("primaryButtons");
            let secondaryBtns = document.getElementById("secondaryButtons")

            primaryBtns.style.display = "flex";
            secondaryBtns.style.display = "none";
            nouvelleDateDiv.style.display = "none";
        })
    </script>
    <script src="https://cdn.jsdelivr.net/npm/air-datepicker@3.5.3/air-datepicker.min.js"></script>
    <script>
        localeFr = {
            days: ['Dimanche', 'Lundi', 'Mardi', 'Mercredi', 'Jeudi', 'Vendredi', 'Samedi'],
            daysShort: ['Dim', 'Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam'],
            daysMin: ['Di', 'Lu', 'Ma', 'Me', 'Je', 'Ve', 'Sa'],
            months: ['Janvier', 'Février', 'Mars', 'Avril', 'Mai', 'Juin', 'Juillet', 'Août', 'Septembre', 'Octobre', 'Novembre', 'Décembre'],
            monthsShort: ['Jan', 'Fév', 'Mars', 'Avr', 'Mai', 'Juin', 'Juil', 'Août', 'Sep', 'Oct', 'Nov', 'Dec'],
            today: "Aujourd'hui",
            clear: 'Effacer',
            dateFormat: 'dd/MM/yyyy',
            timeFormat: 'HH:mm',
            firstDay: 0
        }

        calendars = document.getElementsByClassName("calendar");
        for (i = 0; i<calendars.length; i++) {
            new AirDatepicker("#"+calendars[i].id, {
            locale: localeFr,
            //multipleDates: true,
        });
        }

    </script>
</body>
</html>
